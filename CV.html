<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>About me – C. Rey-Castro</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./images/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-ab8c43c639288706b4add653733e3209.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="About me – C. Rey-Castro">
<meta property="og:description" content="Carlos Rey-Castro’s personal website">
<meta property="og:site_name" content="C. Rey-Castro">
<meta name="twitter:title" content="About me – C. Rey-Castro">
<meta name="twitter:description" content="Carlos Rey-Castro’s personal website">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">C. Rey-Castro</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> <i class="bi bi-house-fill" role="img">
</i> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./CV.html" aria-current="page"> <i class="bi bi-person-fill" role="img">
</i> 
<span class="menu-text">About me</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#education" id="toc-education" class="nav-link active" data-scroll-target="#education"><i class="fa-solid fa-graduation-cap" aria-label="graduation-cap"></i> Education</a></li>
  <li><a href="#experience" id="toc-experience" class="nav-link" data-scroll-target="#experience"><i class="fa-solid fa-building-columns" aria-label="building-columns"></i> Experience</a></li>
  <li><a href="#publications" id="toc-publications" class="nav-link" data-scroll-target="#publications"><i class="fa-solid fa-book" aria-label="book"></i> Publications</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">About me</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>I am a Full Professor of Physical Chemistry at the University of Lleida (Spain) with a PhD in Chemistry from the University of A Coruña. My academic journey has included visiting researcher roles at the Centre for Ecology &amp; Hydrology (UK), Università di Messina (Italy), University of Edinburgh (UK), and Universidad de Concepción (Chile), as well as a postdoctoral position at ICMAB-CSIC in Barcelona.</p>
<p>My research focuses on the environmental behavior and transport of trace metals, organic colloids, microplastics and engineered nanomaterials in natural waters and soils. I am also interested in wastewater treatment methods using adsorption and ion exchange and the study of the thermodynamic properties of ionic liquids, polyelectrolytes, and salt solutions. Currently, my work investigates how Natural Organic Matter (NOM) influences the bioavailability of trace elements and nutrients like phosphorus in waters and soils.</p>
<p>In my lab, we use techniques such as <em>Diffusive Gradients in Thin Films</em> (DGT), <em>Absence of Gradients and Nernstian Equilibrium Stripping</em> (AGNES), alongside numerical simulations to model reaction-diffusion systems and competitive adsorption processes.</p>
<section id="education" class="level2">
<h2 class="anchored" data-anchor-id="education"><i class="fa-solid fa-graduation-cap" aria-label="graduation-cap"></i> Education</h2>
<p>University of A Coruña, Spain:</p>
<ul>
<li>M.Sc. in Chemistry | June 1999</li>
<li>Ph.D.&nbsp;in Chemistry | July 2004</li>
</ul>
</section>
<section id="experience" class="level2">
<h2 class="anchored" data-anchor-id="experience"><i class="fa-solid fa-building-columns" aria-label="building-columns"></i> Experience</h2>
<p>CSIC Institute of Materials Science, Barcelona, Spain:</p>
<ul>
<li>Postdoc researcher | April 2005 - Aug 2006</li>
</ul>
<p>University of Lleida, Spain:</p>
<ul>
<li>Lecturer | Sept 2006 - July 2011</li>
<li>Associate Professor | Aug 2011 - Sept 2021</li>
<li>Full Professor | Oct 2021 - present</li>
</ul>
</section>
<section id="publications" class="level2">
<h2 class="anchored" data-anchor-id="publications"><i class="fa-solid fa-book" aria-label="book"></i> Publications</h2>
<p>Here is a list of my publications including journal articles and book chapters. <a href="./references.bib">Download it as a BibTeX file here</a></p>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Pedroza_2025_RolePhotooxidationOrganic" class="csl-entry" role="listitem">
Pedroza, R., David, C., Barriada, J. L., Rey-Castro, C., &amp; Lodeiro, P. (2025). <em>The <span>Role</span> of <span>Photooxidation</span> and <span>Organic Matter</span> in <span>Cr</span>(<span>III</span>) and <span>Cr</span>(<span>VI</span>) <span>Interactions With Poly</span>(lactic <span>Acid</span>) <span>Microplastics</span> in <span>Aqueous Solution</span></em>. <a href="https://doi.org/10.2139/ssrn.5025818">https://doi.org/10.2139/ssrn.5025818</a>
</div>
<div id="ref-Galceran_2024_AGNESEquilibriumTechnique" class="csl-entry" role="listitem">
Galceran, J., Companys, E., David, C. A., Rey-Castro, C., &amp; Puy, J. (2024). <span>AGNES</span>, an equilibrium technique for the robust speciation of metals and metalloids. In <em>Emerging analytical techniques for chemical speciation studies</em> (Vol. 15, pp. 119–174). World Scientific Publishing Co. <a href="https://doi.org/10.1142/9789811281099_0002">https://doi.org/10.1142/9789811281099_0002</a>
</div>
<div id="ref-Pedroza_2024_InteractionsHumicAcid" class="csl-entry" role="listitem">
Pedroza, R. H. P., David, C., Lodeiro, P., &amp; Rey-Castro, C. (2024). Interactions of humic acid with pristine poly (lactic acid) microplastics in aqueous solution. <em>Science of The Total Environment</em>, <em>908</em>, 168366. <a href="https://doi.org/10.1016/j.scitotenv.2023.168366">https://doi.org/10.1016/j.scitotenv.2023.168366</a>
</div>
<div id="ref-Lodeiro_2023_ProtonBindingCharacteristics" class="csl-entry" role="listitem">
Lodeiro, P., Rey-Castro, C., David, C., Humphreys, M. P., &amp; Gledhill, M. (2023). Proton <span>Binding Characteristics</span> of <span>Dissolved Organic Matter Extracted</span> from the <span>North Atlantic</span>. <em>Environmental Science &amp; Technology</em>, <em>57</em>(50), 21136–21144. <a href="https://doi.org/10.1021/acs.est.3c01810">https://doi.org/10.1021/acs.est.3c01810</a>
</div>
<div id="ref-Gao_2022_DevelopmentsDiffusiveGradients" class="csl-entry" role="listitem">
Gao, Y., Zhou, C., Galceran, J., Rey-Castro, C., Puy, J., Baeyens, W., &amp; Leermakers, M. (2022). Developments in the diffusive gradients in thin-films technique for the speciation of oxyanions and platinum group elements in aquatic systems. <em>TrAC Trends in Analytical Chemistry</em>, <em>147</em>, 116513. <a href="https://doi.org/10.1016/j.trac.2021.116513">https://doi.org/10.1016/j.trac.2021.116513</a>
</div>
<div id="ref-Galceran_2021_SpeciationInorganicCompounds" class="csl-entry" role="listitem">
Galceran, J., Gao, Y., Puy, J., Leermakers, M., Rey-Castro, C., Zhou, C., &amp; Baeyens, W. (2021). Speciation of <span>Inorganic Compounds</span> in <span>Aquatic Systems Using Diffusive Gradients</span> in <span>Thin-Films</span>: <span>A Review</span>. <em>Frontiers in Chemistry</em>, <em>9</em>, 624511. <a href="https://doi.org/10.3389/fchem.2021.624511">https://doi.org/10.3389/fchem.2021.624511</a>
</div>
<div id="ref-Giuffre_2021_EditorialAdvancesAnalytical" class="csl-entry" role="listitem">
Giuffre, O., Napoli, A., &amp; Rey-Castro, C. (2021). Editorial: <span>Advances</span> in <span>Analytical Techniques</span> and <span>Methodology</span> for <span>Chemical Speciation Study</span>. <em>Frontiers in Chemistry</em>, <em>9</em>, 692144. <a href="https://doi.org/10.3389/fchem.2021.692144">https://doi.org/10.3389/fchem.2021.692144</a>
</div>
<div id="ref-Lodeiro_2021_SeasonalVariationsProton" class="csl-entry" role="listitem">
Lodeiro, P., Rey-Castro, C., David, C., Puy, J., Achterberg, E. P., &amp; Gledhill, M. (2021). Seasonal <span>Variations</span> in <span>Proton Binding Characteristics</span> of <span>Dissolved Organic Matter Isolated</span> from the <span>Southwest Baltic Sea</span>. <em>Environmental Science &amp; Technology</em>, <em>55</em>(23), 16215–16223. <a href="https://doi.org/10.1021/acs.est.1c04773">https://doi.org/10.1021/acs.est.1c04773</a>
</div>
<div id="ref-Lodeiro_2020_AcidbasePropertiesDissolved" class="csl-entry" role="listitem">
Lodeiro, P., Rey-Castro, C., David, C., Achterberg, E. P., Puy, J., &amp; Gledhill, M. (2020). Acid-base properties of dissolved organic matter extracted from the marine environment. <em>Science of the Total Environment</em>, <em>729</em>, 138437. <a href="https://doi.org/10.1016/j.scitotenv.2020.138437">https://doi.org/10.1016/j.scitotenv.2020.138437</a>
</div>
<div id="ref-Altier_2019_TimeWeightedAverage" class="csl-entry" role="listitem">
Altier, A., Jimenez-Piedrahita, M., Uribe, R., Rey-Castro, C., Galceran, J., &amp; Puy, J. (2019). Time weighted average concentrations measured with <span>Diffusive Gradients</span> in <span>Thin</span> films (<span>DGT</span>). <em>Analytica Chimica Acta</em>, <em>1060</em>, 114–124. <a href="https://doi.org/10.1016/j.aca.2019.01.056">https://doi.org/10.1016/j.aca.2019.01.056</a>
</div>
<div id="ref-David_2019_DissolutionPhosphateInducedTransformation" class="csl-entry" role="listitem">
David, C. A., Galceran, J., Quattrini, F., Puy, J., &amp; Rey-Castro, C. (2019). Dissolution and <span>Phosphate-Induced Transformation</span> of <span>ZnO Nanoparticles</span> in <span>Synthetic Saliva Probed</span> by <span>AGNES</span> without <span>Previous Solid-Liquid Separation</span>. <span>Comparison</span> with <span>UF-ICP-MS</span>. <em>Environmental Science &amp; Technology</em>, <em>53</em>(7), 3823–3831. <a href="https://doi.org/10.1021/acs.est.8b06531">https://doi.org/10.1021/acs.est.8b06531</a>
</div>
<div id="ref-Quattrini_2019_AssessmentLabilitiesMetal" class="csl-entry" role="listitem">
Quattrini, F., Galceran, J., Rey-Castro, C., Puy, J., &amp; Fortin, C. (2019). Assessment of labilities of metal complexes with the dynamic ion exchange technique. <em>Environmental Chemistry</em>, <em>16</em>(3), 151–164. <a href="https://doi.org/10.1071/EN18202">https://doi.org/10.1071/EN18202</a>
</div>
<div id="ref-Altier_2018_EffectsMixtureLigands" class="csl-entry" role="listitem">
Altier, A., Jimenez-Piedrahita, M., Uribe, R., Rey-Castro, C., Cecilia, J., Galceran, J., &amp; Puy, J. (2018). Effects of a mixture of ligands on metal accumulation in diffusive gradients in thin films (<span>DGT</span>). <em>Environmental Chemistry</em>, <em>15</em>(3), 183–193. <a href="https://doi.org/10.1071/EN17232">https://doi.org/10.1071/EN17232</a>
</div>
<div id="ref-Lodeiro_2018_EffectPolymerCoating" class="csl-entry" role="listitem">
Lodeiro, P., Achterberg, E. P., Rey-Castro, C., &amp; El-Shahawi, M. S. (2018). Effect of polymer coating composition on the aggregation rates of <span>Ag</span> nanoparticles in <span>NaCl</span> solutions and seawaters. <em>Science of the Total Environment</em>, <em>631–632</em>, 1153–1162. <a href="https://doi.org/10.1016/j.scitotenv.2018.03.131">https://doi.org/10.1016/j.scitotenv.2018.03.131</a>
</div>
<div id="ref-Garces_2017_DealingLongrangeInteractions" class="csl-entry" role="listitem">
Garces, J. L., Madurga, S., Rey-Castro, C., &amp; Mas, F. (2017). Dealing with long-range interactions in the determination of polyelectrolyte ionization properties. <span>Extension</span> of the transfer matrix formalism to the full range of ionic strengths. <em>Journal of Polymer Science Part B-Polymer Physics</em>, <em>55</em>(3), 275–284. <a href="https://doi.org/10.1002/polb.24269">https://doi.org/10.1002/polb.24269</a>
</div>
<div id="ref-Jimenez-Piedrahita_2017_ExtendingUseDiffusive" class="csl-entry" role="listitem">
Jimenez-Piedrahita, M., Altier, A., Cecilia, J., Puy, J., Galceran, J., Rey-Castro, C., Zhang, H., &amp; Davison, W. (2017). Extending the <span>Use</span> of <span>Diffusive Gradients</span> in <span>Thin Films</span> (<span>DGT</span>) to <span>Solutions Where Competition</span>, <span>Saturation</span>, and <span>Kinetic Effects Are Not Negligible</span>. <em>Analytical Chemistry</em>, <em>89</em>(12), 6567–6574. <a href="https://doi.org/10.1021/acs.analchem.7b00704">https://doi.org/10.1021/acs.analchem.7b00704</a>
</div>
<div id="ref-Puy_2017_ForewordSpecialIssue" class="csl-entry" role="listitem">
Puy, J., Galceran, J., &amp; Rey-Castro, C. (2017). Foreword to the <span>Special Issue</span> from the <span>Interfaces Against Pollution</span> 2016 <span>Conference</span>: <span>Environmental Challenges</span> and <span>Opportunities Foreword</span>. <em>Environmental Chemistry</em>, <em>14</em>(5), I–II. <a href="https://doi.org/10.1071/ENv14n5_FO">https://doi.org/10.1071/ENv14n5_FO</a>
</div>
<div id="ref-Quattrini_2017_DynamicsTraceMetal" class="csl-entry" role="listitem">
Quattrini, F., Galceran, J., David, C. A., Puy, J., Alberti, G., &amp; Rey-Castro, C. (2017). Dynamics of trace metal sorption by an ion-exchange chelating resin described by a mixed intraparticle/film diffusion transport model. <span>The Cd</span>/<span>Chelex</span> case. <em>Chemical Engineering Journal</em>, <em>317</em>, 810–820. <a href="https://doi.org/10.1016/j.cej.2017.02.115">https://doi.org/10.1016/j.cej.2017.02.115</a>
</div>
<div id="ref-Waite_2017_ForewordSpecialIssue" class="csl-entry" role="listitem">
Waite, T. D., Duval, J. F. L., Sander, M., Puy, J., Galceran, J., &amp; Rey-Castro, C. (2017). Foreword to the <span>Special Issue</span> from the <span>Interfaces Against Pollution</span> 2016 <span>Conference</span>: <span>Environmental Challenges</span> and <span>Opportunities</span> (vol 14, pg i, 2017). <em>Environmental Chemistry</em>, <em>14</em>(5), A–A. <a href="https://doi.org/10.1071/ENv14n5_FO_CO">https://doi.org/10.1071/ENv14n5_FO_CO</a>
</div>
<div id="ref-Altier_2016_AccumulationMgDiffusive" class="csl-entry" role="listitem">
Altier, A., Jimenez-Piedrahita, M., Rey-Castro, C., Cecilia, J., Galceran, J., &amp; Puy, J. (2016). Accumulation of <span>Mg</span> to <span>Diffusive Gradients</span> in <span>Thin Films</span> (<span>DGT</span>) <span>Devices</span>: <span>Kinetic</span> and <span>Thermodynamic Effects</span> of the <span>Ionic Strength</span>. <em>Analytical Chemistry</em>, <em>88</em>(20), 10245–10251. <a href="https://doi.org/10.1021/acs.analchem.6b02961">https://doi.org/10.1021/acs.analchem.6b02961</a>
</div>
<div id="ref-Puy_2016_InterpretingDGTMeasurement" class="csl-entry" role="listitem">
Puy, J., Galceran, J., &amp; Rey-Castro, C. (2016). Interpreting the <span>DGT Measurement Speciation</span> and <span>Dynamics</span>. In W. Davison (Ed.), <em>Diffusive <span>Gradients</span> in <span>Thin-Films</span> for <span>Environmental Measurements</span></em> (pp. 93–122). Cambridge Univ Press. <a href="https://www.webofscience.com/wos/alldb/summary/ace73fc0-bdb6-4b49-bcbb-e2ade45d1011-20c16203/relevance/1">https://www.webofscience.com/wos/alldb/summary/ace73fc0-bdb6-4b49-bcbb-e2ade45d1011-20c16203/relevance/1</a>
</div>
<div id="ref-Tantra_2016_SuitabilityAnalyticalMethods" class="csl-entry" role="listitem">
Tantra, R., Bouwmeester, H., Bolea, E., Rey-Castro, C., David, C. A., Dogne, J.-M., Jarman, J., Laborda, F., Laloy, J., Robinson, K. N., Undas, A. K., &amp; van der Zande, M. (2016). Suitability of analytical methods to measure solubility for the purpose of nanoregulation. <em>Nanotoxicology</em>, <em>10</em>(2), 173–184. <a href="https://doi.org/10.3109/17435390.2015.1038661">https://doi.org/10.3109/17435390.2015.1038661</a>
</div>
<div id="ref-Jimenez-Piedrahita_2015_InfluenceSettlingResin" class="csl-entry" role="listitem">
Jimenez-Piedrahita, M., Altier, A., Cecilia, J., Rey-Castro, C., Galceran, J., &amp; Puy, J. (2015). Influence of the settling of the resin beads on diffusion gradients in thin films measurements. <em>Analytica Chimica Acta</em>, <em>885</em>, 148–155. <a href="https://doi.org/10.1016/j.aca.2015.04.054">https://doi.org/10.1016/j.aca.2015.04.054</a>
</div>
<div id="ref-Galceran_2014_ImpactElectrodicAdsorption" class="csl-entry" role="listitem">
Galceran, J., Lao, M., David, C., Companys, E., Rey-Castro, C., Salvador, J., &amp; Puy, J. (2014). The impact of electrodic adsorption on <span>Zn</span>, <span>Cd</span> and <span>Pb</span> speciation measurements with <span>AGNES</span>. <em>Journal of Electroanalytical Chemistry</em>, <em>722</em>, 110–118. <a href="https://doi.org/10.1016/j.jelechem.2014.03.037">https://doi.org/10.1016/j.jelechem.2014.03.037</a>
</div>
<div id="ref-Mu_2014_SystematicInvestigationPhysicochemical" class="csl-entry" role="listitem">
Mu, Q., David, C. A., Galceran, J., Rey-Castro, C., Krzeminski, L., Wallace, R., Bamiduro, F., Milne, S. J., Hondow, N. S., Brydson, R., Vizcay-Barrena, G., Routledge, M. N., Jeuken, L. J. C., &amp; Brown, A. P. (2014). Systematic <span>Investigation</span> of the <span>Physicochemical Factors That Contribute</span> to the <span>Toxicity</span> of <span>ZnO Nanoparticles</span>. <em>Chemical Research in Toxicology</em>, <em>27</em>(4), 558–567. <a href="https://doi.org/10.1021/tx4004243">https://doi.org/10.1021/tx4004243</a>
</div>
<div id="ref-Lopez-Garcia_2013_ExperimentalEvidencesNew" class="csl-entry" role="listitem">
Lopez-Garcia, M., Lodeiro, P., Herrero, R., Barriada, J. L., Rey-Castro, C., David, C., &amp; Sastre de Vicente, M. E. (2013). Experimental evidences for a new model in the description of the adsorption-coupled reduction of <span>Cr</span>(<span>VI</span>) by protonated banana skin. <em>Bioresource Technology</em>, <em>139</em>, 181–189. <a href="https://doi.org/10.1016/j.biortech.2013.04.044">https://doi.org/10.1016/j.biortech.2013.04.044</a>
</div>
<div id="ref-Mongin_2013_LimitsLinearAccumulation" class="csl-entry" role="listitem">
Mongin, S., Uribe, R., Rey-Castro, C., Cecilia, J., Galceran, J., &amp; Puy, J. (2013). Limits of the <span>Linear Accumulation Regime</span> of <span>DGT Sensors</span>. <em>Environmental Science &amp; Technology</em>, <em>47</em>(18), 10438–10445. <a href="https://doi.org/10.1021/es400609y">https://doi.org/10.1021/es400609y</a>
</div>
<div id="ref-Reyes_2013_SurfaceTension1Ethyl3methylimidazolium" class="csl-entry" role="listitem">
Reyes, G., Cartes, M., Rey-Castro, C., Segura, H., &amp; Mejia, A. (2013). Surface <span>Tension</span> of 1-<span class="nocase">Ethyl-3-methylimidazolium Ethyl Sulfate</span> or 1-<span class="nocase">Butyl-3-methylimidazolium Hexafluorophosphate</span> with <span>Argon</span> and <span>Carbon Dioxide</span>. <em>Journal of Chemical and Engineering Data</em>, <em>58</em>(5), 1203–1211. <a href="https://doi.org/10.1021/je3013414">https://doi.org/10.1021/je3013414</a>
</div>
<div id="ref-David_2012_DissolutionKineticsSolubility" class="csl-entry" role="listitem">
David, C. A., Galceran, J., Rey-Castro, C., Puy, J., Companys, E., Salvador, J., Monne, J., Wallace, R., &amp; Vakourov, A. (2012). Dissolution <span>Kinetics</span> and <span>Solubility</span> of <span>ZnO Nanoparticles Followed</span> by <span>AGNES</span>. <em>Journal of Physical Chemistry C</em>, <em>116</em>(21), 11758–11767. <a href="https://doi.org/10.1021/jp301671b">https://doi.org/10.1021/jp301671b</a>
</div>
<div id="ref-Herrero_2011_FullDescriptionCopper" class="csl-entry" role="listitem">
Herrero, R., Lodeiro, P., Garcia-Casal, L. J., Vilarino, T., Rey-Castro, C., David, C., &amp; Rodriguez, P. (2011). Full description of copper uptake by algal biomass combining an equilibrium <span>NICA</span> model with a kinetic intraparticle diffusion driving force approach. <em>Bioresource Technology</em>, <em>102</em>(3), 2990–2997. <a href="https://doi.org/10.1016/j.biortech.2010.10.007">https://doi.org/10.1016/j.biortech.2010.10.007</a>
</div>
<div id="ref-Madurga_2011_SemigrandCanonicalMonte" class="csl-entry" role="listitem">
Madurga, S., Rey-Castro, C., Pastor, I., Vilaseca, E., David, C., Lluis Garces, J., Puy, J., &amp; Mas, F. (2011). A semi-grand canonical <span>Monte Carlo</span> simulation model for ion binding to ionizable surfaces: <span>Proton</span> binding of carboxylated latex particles as a case study. <em>Journal of Chemical Physics</em>, <em>135</em>(18), 184103. <a href="https://doi.org/10.1063/1.3658484">https://doi.org/10.1063/1.3658484</a>
</div>
<div id="ref-David_2010_CompetitionEffectsCation" class="csl-entry" role="listitem">
David, C., Mongin, S., Rey-Castro, C., Galceran, J., Companys, E., Luis Garces, J., Salvador, J., Puy, J., Cecilia, J., Lodeiro, P., &amp; Mas, F. (2010). Competition effects in cation binding to humic acid: <span>Conditional</span> affinity spectra for fixed total metal concentration conditions. <em>Geochimica Et Cosmochimica Acta</em>, <em>74</em>(18), 5216–5227. <a href="https://doi.org/10.1016/j.gca.2010.06.023">https://doi.org/10.1016/j.gca.2010.06.023</a>
</div>
<div id="ref-Madurga_2009_IonBindingPolyelectrolytes" class="csl-entry" role="listitem">
Madurga, S., Lluis Garces, J., Companys, E., Rey-Castro, C., Salvador, J., Galceran, J., Vilaseca, E., Puy, J., &amp; Mas, F. (2009). Ion binding to polyelectrolytes: <span>Monte Carlo</span> simulations versus classical mean field theories. <em>Theoretical Chemistry Accounts</em>, <em>123</em>(1–2), 127–135. <a href="https://doi.org/10.1007/s00214-009-0550-z">https://doi.org/10.1007/s00214-009-0550-z</a>
</div>
<div id="ref-Puy_2009_ConditionalAffinitySpectra" class="csl-entry" role="listitem">
Puy, J., Huidobro, C., David, C., Rey-Castro, C., Salvador, J., Companys, E., Garces, J. L., Galceran, J., Cecilia, J., &amp; Mas, F. (2009). Conditional affinity spectra underlying <span>NICA</span> isotherm. <em>Colloids and Surfaces a-Physicochemical and Engineering Aspects</em>, <em>347</em>(1–3), 156–166. <a href="https://doi.org/10.1016/j.colsurfa.2009.03.053">https://doi.org/10.1016/j.colsurfa.2009.03.053</a>
</div>
<div id="ref-Rey-Castro_2009_EffectiveAffinityDistribution" class="csl-entry" role="listitem">
Rey-Castro, C., Mongin, S., Huidobro, C., David, C., Salvador, J., Lluis Garces, J., Galceran, J., Mas, F., &amp; Puy, J. (2009). Effective <span>Affinity Distribution</span> for the <span>Binding</span> of <span>Metal Ions</span> to a <span>Generic Fulvic Acid</span> in <span>Natural Waters</span>. <em>Environmental Science &amp; Technology</em>, <em>43</em>(19), 7184–7191. <a href="https://doi.org/10.1021/es803006p">https://doi.org/10.1021/es803006p</a>
</div>
<div id="ref-David_2008_CompetitiveCd2Complexation" class="csl-entry" role="listitem">
David, C., Companys, E., Galceran, J., Lluis Garces, J., Mas, F., Rey-Castro, C., Salvador, J., &amp; Puy, J. (2008). Competitive <span>Cd2</span>+/<span>H</span>+ complexation to polyacrylic acid described by the stepwise and intrinsic stability constants. <em>Journal of Physical Chemistry B</em>, <em>112</em>(33), 10092–10100. <a href="https://doi.org/10.1021/jp802571f">https://doi.org/10.1021/jp802571f</a>
</div>
<div id="ref-David_2007_CompetitiveIonComplexation" class="csl-entry" role="listitem">
David, C., Companys, E., Galceran, J., Lluis Garces, J., Mas, F., Rey-Castro, C., Salvador, J., &amp; Puy, J. (2007). Competitive ion complexation to polyelectrolytes: <span>Determination</span> of the stepwise stability constants. The <span>Ca2</span>+/<span>H</span>+/<span>Polyacrylate</span> system. <em>Journal of Physical Chemistry B</em>, <em>111</em>(35), 10421–10430. <a href="https://doi.org/10.1021/jp0741206">https://doi.org/10.1021/jp0741206</a>
</div>
<div id="ref-Rey-Castro_2007_EffectFlexibilityAnion" class="csl-entry" role="listitem">
Rey-Castro, C., Tormo, A. L., &amp; Vega, L. F. (2007). Effect of the flexibility and the anion in the structural and transport properties of ethyl-methyl-imidazolium ionic liquids. <em>Fluid Phase Equilibria</em>, <em>256</em>(1–2), 62–69. <a href="https://doi.org/10.1016/j.fluid.2006.09.027">https://doi.org/10.1016/j.fluid.2006.09.027</a>
</div>
<div id="ref-Herrero_2006_InteractionsCadmiumII" class="csl-entry" role="listitem">
Herrero, R., Cordero, B., Lodeiro, P., Rey-Castro, C., &amp; Sastre De Vicente, M. E. (2006). Interactions of cadmium(<span>II</span>) and protons with dead biomass of marine algae <span>Fucus</span> sp. <em>Marine Chemistry</em>, <em>99</em>(1–4), 106–116. <a href="https://doi.org/10.1016/j.marchem.2005.05.009">https://doi.org/10.1016/j.marchem.2005.05.009</a>
</div>
<div id="ref-Rey-Castro_2006_TransportPropertiesIonic" class="csl-entry" role="listitem">
Rey-Castro, C., &amp; Vega, L. F. (2006). Transport properties of the ionic liquid 1-ethyl-3-methylimidazolium chloride from equilibrium molecular dynamics simulation. <span>The</span> effect of temperature. <em>Journal of Physical Chemistry B</em>, <em>110</em>(29), 14426–14435. <a href="https://doi.org/10.1021/jp062885s">https://doi.org/10.1021/jp062885s</a>
</div>
<div id="ref-Bretti_2005_InteractionAcrylicmaleicCopolymers" class="csl-entry" role="listitem">
Bretti, C., Crea, F., Rey-Castro, C., &amp; Sammartano, S. (2005). Interaction of acrylic-maleic copolymers with <span>H</span>+, <span>Na</span>+<span>Mg2</span>+ and <span>Ca2</span>+ : <span>Thermodynamic</span> parameters and their dependence on medium. <em>Reactive &amp; Functional Polymers</em>, <em>65</em>(3), 329–342. <a href="https://doi.org/10.1016/j.reactfunctpolym.2005.07.005">https://doi.org/10.1016/j.reactfunctpolym.2005.07.005</a>
</div>
<div id="ref-Herrero_2005_RemovalInorganicMercury" class="csl-entry" role="listitem">
Herrero, R., Lodeiro, P., Rey-Castro, C., Vilarino, T., &amp; de Vicente, M. E. S. (2005). Removal of inorganic mercury from aqueous solutions by biomass of the marine macroalga <span>Cystoseira</span> baccata. <em>Water Research</em>, <em>39</em>(14), 3199–3210. <a href="https://doi.org/10.1016/j.watres.2005.05.041">https://doi.org/10.1016/j.watres.2005.05.041</a>
</div>
<div id="ref-Lodeiro_2005_BiosorptionCadmiumProtonated" class="csl-entry" role="listitem">
Lodeiro, P., Rey-Castro, C., Barriada, J. L., de Vicente, M. E. S., &amp; Herrero, R. (2005). Biosorption of cadmium by the protonated macroalga <span>Sargassum</span> muticum: <span>Binding</span> analysis with a nonideal, competitive, and thermodynamically consistent adsorption (<span>NICCA</span>) model. <em>Journal of Colloid and Interface Science</em>, <em>289</em>(2), 352–358. <a href="https://doi.org/10.1016/j.jcis.2005.04.002">https://doi.org/10.1016/j.jcis.2005.04.002</a>
</div>
<div id="ref-Rey-Castro_2004_GibbsDonnanSpecificionInteraction" class="csl-entry" role="listitem">
Rey-Castro, C., Herrero, R., &amp; de Vicente, M. E. S. (2004). Gibbs-<span>Donnan</span> and specific-ion interaction theory descriptions of the effect of ionic strength on proton dissociation of alginic acid. <em>Journal of Electroanalytical Chemistry</em>, <em>564</em>(1–2), 223–230. <a href="https://doi.org/10.1016/j.jelechem.2003.10.023">https://doi.org/10.1016/j.jelechem.2003.10.023</a>
</div>
<div id="ref-Rey-Castro_2004_SurfaceChargePermeable" class="csl-entry" role="listitem">
Rey-Castro, C., Herrero, R., &amp; de Vicente, M. E. S. (2004). Surface charge and permeable gel descriptions of the ionic strength influence on proton binding to seaweed biomass. <em>Chemical Speciation and Bioavailability</em>, <em>16</em>(1–2), 61–69. <a href="https://doi.org/10.3184/095422904782775117">https://doi.org/10.3184/095422904782775117</a>
</div>
<div id="ref-Smith_2004_CationBindingAcidwashed" class="csl-entry" role="listitem">
Smith, E. J., Rey-Castro, C., Longworth, H., Lofts, S., Lawlor, A. J., &amp; Tipping, E. (2004). Cation binding by acid-washed peat, interpreted with humic ion-binding model <span>VI-FD</span>. <em>European Journal of Soil Science</em>, <em>55</em>(3), 433–447. <a href="https://doi.org/10.1111/j.1365-2389.2004.00607.x">https://doi.org/10.1111/j.1365-2389.2004.00607.x</a>
</div>
<div id="ref-Smith_2004_CationBindingAcidwasheda" class="csl-entry" role="listitem">
Smith, E. J., Rey-Castro, C., Longworth, H., Lofts, S., Lawlor, A. J., &amp; Tipping, E. (2004). Cation binding by acid-washed peat, interpreted with <span>Humic Ion-Binding Model VI-FD</span> (vol 55, pg 433, 2004). <em>European Journal of Soil Science</em>, <em>55</em>(4), 815–815. <a href="https://doi.org/10.1111/j.1365-2389.2004.00684.x">https://doi.org/10.1111/j.1365-2389.2004.00684.x</a>
</div>
<div id="ref-Rey-Castro_2003_AcidbaseEquilibriaPhthalic" class="csl-entry" role="listitem">
Rey-Castro, C., Castro-Varela, R., Herrero, R., &amp; de Vicente, M. E. S. (2003). Acid-base equilibria of phthalic acid in saline media: Ion association from <span class="nocase">Pitzer-equations</span>. <em>Talanta</em>, <em>60</em>(1), 93–101. <a href="https://doi.org/10.1016/S0039-9140(03)00040-7">https://doi.org/10.1016/S0039-9140(03)00040-7</a>
</div>
<div id="ref-Rey-Castro_2003_AcidbasePropertiesBrown" class="csl-entry" role="listitem">
Rey-Castro, C., Lodeiro, P., Herrero, R., &amp; De Vicente, M. E. S. (2003). Acid-base properties of brown seaweed biomass considered as a <span>Donnan</span> gel. <span>A</span> model reflecting electrostatic effects and chemical heterogeneity. <em>Environmental Science &amp; Technology</em>, <em>37</em>(22), 5159–5167. <a href="https://doi.org/10.1021/es0343353">https://doi.org/10.1021/es0343353</a>
</div>
<div id="ref-Castro-Varela_2002_PotentiometricStudyAcetylsalicylic" class="csl-entry" role="listitem">
Castro-Varela, R., Rey-Castro, C., Vilarino, T., &amp; de Vicente, M. E. S. (2002). Potentiometric study of acetylsalicylic acid: <span>Solubility</span> and acid-base equilibria in different saline media at 298 <span>K</span>. <em>Journal of Chemical and Engineering Data</em>, <em>47</em>(6), 1432–1435. <a href="https://doi.org/10.1021/je020059g">https://doi.org/10.1021/je020059g</a>
</div>
<div id="ref-Tipping_2002_IIIFeIII" class="csl-entry" role="listitem">
Tipping, E., Rey-Castro, C., Bryan, S. E., &amp; Hamilton-Taylor, J. (2002). Al(<span>III</span>) and <span>Fe</span>(<span>III</span>) binding by humic substances in freshwaters, and implications for trace metal speciation. <em>Geochimica Et Cosmochimica Acta</em>, <em>66</em>(18), 3211–3224. <a href="https://doi.org/10.1016/S0016-7037(02)00930-4">https://doi.org/10.1016/S0016-7037(02)00930-4</a>
</div>
</div>


</section>

<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/CarlosReyCastro\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2025 by Carlos Rey-Castro. The content of this website is licensed under <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/?ref=chooser-v1">CC BY-NC-ND 4.0</a> <img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/png/by-nc-nd.png" class="img-fluid" width="60"></p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>